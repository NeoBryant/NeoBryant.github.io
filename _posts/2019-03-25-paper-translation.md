---
layout: post
title: 论文翻译 - RESIDUAL AND PLAIN CONVOLUTIONAL NEURAL NETWORKS FOR 3D BRAIN MRI CLASSIFICATION
category: Deep Learing 
description: 近年来，有许多研究将深度学习算法应用于神经成像数据。这些研究中使用的方法大多需要多个处理步骤来提取特征，尽管现代图像分类深度学习中的进步可以为自动生成特征和更直接的分析提供一个强大的框架。在本文中，我们展示了如何使用残差和普通（residual and plain）的三维卷积神经网络结构来跳过这些特征提取的步骤，从而获得相似的性能。我们在阿兹海默氏症国家计划(ADNI)的三维结构核磁共振脑扫描数据集上展示了该方法的性能，该方法用于阿尔茨海默氏症与轻度认知障碍和正常对照的分类。
---



[原文连接](https://arxiv.org/abs/1701.06643v1)



## 残差和平卷积神经网络用于三维脑MRI分类

> 23 Jan 2017
>
> 
>
> ABSTACT
>
> 近年来，有许多研究将深度学习算法应用于神经成像数据。这些研究中使用的方法大多需要多个处理步骤来提取特征，尽管现代图像分类深度学习中的进步可以为自动生成特征和更直接的分析提供一个强大的框架。在本文中，我们展示了如何使用残差和普通（residual and plain）的三维卷积神经网络结构来跳过这些特征提取的步骤，从而获得相似的性能。我们在阿兹海默氏症国家计划(ADNI)的三维结构核磁共振脑扫描数据集上展示了该方法的性能，该方法用于阿尔茨海默氏症与轻度认知障碍和正常对照的分类。
>
> 
>
> 关键词：MRI，老年痴呆症，深度学习，卷积神经网络，残差神经网络-工作





### 1. 简介（INTRODUCTION ）

​	越来越多的基于神经成像数据的机器学习研究旨在开发有助于脑部MRI分类和自动体积分割的诊断工具，并了解疾病的机制，包括神经退行性疾病。最近，出现了几个使用深度学习进行三维结构磁共振图像（MRI）处理的出版物，其中特定算法的范围从使用限制玻尔兹曼机器的流形学习[1]到自动编码器和分类器的组合[2] ]以及对不同最新技术方法的meta分析[3]。

​	在这些研究中，MRI分类问题通常用于复杂的多步骤流水线，用于手工制作特征生成和从标准机器学习技术（如支持向量机（SVM）或用于分类的逻辑回归）之前的数据中提取特征。在我们的研究中，我们开发了基于深度学习的算法，这些算法有可能通过端到端模型克服这个问题并简化MRI分类管道。

​	此外，值得注意的是，与目前用于在2D图像分析中训练神经网络进行对象分类和检测的图像分类数据集的大小相比，在神经成像研究中收集的数据集通常非常小。 虽然最近的研究旨在通过过采样来克服这个问题（例如，[4]），但在监督学习设置中，能够构建能够学习基于分类所必需的功能的网络架构仍然是非常重要的。 在小数据集上。

​	在本文中，我们提出了两种不同的用于脑MRI分类的3D卷积网络架构，它们是对普通和残余卷积神经网络的修改。 我们选择使用卷积神经网络来解决上述两个问题。 首先，这些网络可以将局部特征概括为用于图像识别或分类的对象的元表示。 其次，图像分类深度学习的现代进步，如批量标准化技术和剩余网络体系结构，缓解了小型训练数据集的问题，同时为自动特征生成提供了强大的框架。 因此，我们的模型可以应用于3D MRI图像，而无需中间手工制作的特征提取。

​	我们根据阿尔茨海默病神经影像学计划（ADNI）项目提供的数据检查所提出的网络架构的性能，该项目提供了带有标签和主题元数据的结构MRI扫描数据集。我们使用该数据集来测试我们的模型的性能，以便对患有阿尔茨海默病（AD），早期和晚期轻度认知障碍（EMCI和LMCI）以及正常队列（NC）的受试者进行MRI扫描分类。

​	以前的研究使用深度学习算法进行阿尔茨海默病分类。例如，Heung-Il Suk等人。 [5]使用深度置信网络（DBN）的复杂架构，其中补丁采样预处理以及MRI和PET模态的组合，以及网络顶部的SVM分类器的加权集合。预处理包括颅骨剥离和大脑去除，分为灰质，白质和脑脊液（CSF），以及采样贴片作为具有统计学意义的体素的邻域。由此产生的AD/NC，MCI/NC和MCIC/MCI-NC的分类性能为.95，.85，.76准确度和.99，.88，.75 ROC AUC。

​	在最近关于ADNI数据分类的论文中，Ehsan Hosseini-Asl等人。 [6]提出使用3D卷积神经网络从MRI中提取特征。更具体地说，[6]的作者使用深度监督的自适应3D-CNN（DSA-3D-CNN），其通过训练卷积自动编码器进行初始化，用于特征提取和微调网络以在不同域图像上进行分类。与二元ROC AUC超过0.96的其他方法相比，它们表现出令人印象深刻的性能。这种方法最接近我们提出的方法，但它有一些注意事项。虽然对于某些类型的数据，这种方法可以产生更好的初始性能，但它在权重初始化的时间复杂性方面存在缺点。

​	一个重要的注意事项是，之前基于ADNI的研究报告了可用类对的二元分类结果，而不是多类分类。在我们的研究中，我们还在二元一对一分类的任务中测试所提出的模型的性能，以便能够将我们的结果与先前的工作进行比较。我们证明了我们的方法在没有复杂的预处理或模型堆叠的情况下实现了相对较好的结果，同时在数据增强和过采样以及模型架构设计方面展示了一系列可能的进一步研究途径。

​	

### 2. 方法（METHOD）

​	我们将两种不同的大脑MRI分类方法与卷积神经网络进行比较。 第一个是具有卷积和池层的公共前馈网络，第二个是现代残差神经网络。**对于每个体系结构，我们运行了大量实验来确定层数（the number of layers），每层的卷积核数量（number of filters for each layer），学习率（learning rate），池化大小（pooling size）和丢失概率（dropout probability）。**



#### 2.1. VoxCNN

​	我们选择使用类似于VGG [7]的网络架构进行图像分类，以检查这种类型的卷积网络是否能够提取3D图像分类所需的特征。

​	我们的VoxCNN架构有四个用于提取特征的立体卷积块（由多个卷积核逐层增加），两个带有（batchnorm）和（dropout）的反卷积层用于正则化，输出具有softmax非线性用于分类（见图1（a）））。 我们使用 **AdaM** 训练最终的**二元分类模型**，**学习率为 $$27 * 10^{-6}$$，批量大小为5个对于150个时期（batchsize of 5 for 150 epochs）。**


![image]({{site.baseurl}}/assets/img/dl/6.png)


#### 2.2. ResNet

​	残余神经网络[8]架构在2015年赢得了Imagenet竞赛，并展示了在快速收敛的同时极大地改善网络深度的可能性。已有出版物展示了他们的3D图像分割结果，如VoxResNet [9]，其中作者使用ResNets的身份连接思想[10]。

​	我们从VoxResNet派生的ResNet架构有21层，包含6个VoxRes块，每个块有64个用于卷积的卷积核，除了最后两个，其中有128个和在VoxRes块之间有2×2×2步幅的卷积，以减小卷的尺寸。图层输出。最后一个VoxRes块的输出被发送到池化层以进一步将其减少到2×2×2×128，接着是具有128个隐藏单元的完全连接层和具有Softmax非线性的二进制分类的输出（见图1（b））。我们使用Nesterov动量训练最终的二元分类模型，学习率为 $$10^{-4}$$，并且批量大小为3对于70个时期（batchsize of 3 for 70 epochs）。



#### 2.3. Setup

​	我们每次运行 **5-fold 交叉验证**，每次5次不同的折叠分割，以获得更好的预测性能近似值。 在每个折叠上，我们为每个分类任务训练网络一定数量的时期，以在数据集的训练子集上获得完美的类别分离，并稳定验证子集上的性能指标。

​	同样重要的是要注意，由于模型大小和GPU内存的限制，我们必须修改批处理迭代过程，以便我们确保每个批次中都有每个类的样本。 原因在于，对于无限数量的样本，在批次内仅表示一个类的概率是1，其中 $$c$$ 是 $$\frac{1}{c^b}$$ 类的数量，$$b$$ 是批量大小（batchsize）。 因此，对于大批量生产，这种可能性很低，但在我们的情况下，它足以使学习过程不稳定。 每批中的样品平衡为我们提供了更稳定的学习曲线。



### 3. 数据（DATA）

​	用于制备本文的数据来自阿尔茨海默氏病神经影像学倡议（ADNI）数据库（adni.loni.usc.edu）。 因此，ADNI内的研究人员为ADNI的设计和实施做出了贡献和/或提供了数据，但没有参与本报告的分析或撰写。 有关ADNI调查员的完整列表，请访问 http://adni.loni.usc.edu/wp-content/uploads/how_to_apply/ADNI_Acknowledgement_List.pdf

​	对于我们的实验，我们使用ADNI结构MRI数据的子集，该数据已经被预处理，具有对准和颅骨剥离，标记为“空间归一化，掩蔽和N3校正的T1图像”。 由于有些患者在一段时间内拍摄了多张图像，并且我们希望防止可能的信息“泄漏”，我们只选择为每个受试者拍摄的第一张图像。 得到的数据集有231个四类类别的图像：50个阿尔茨海默病（AD）患者，43个晚期轻度认知障碍（LMCI），77个早期轻度认知障碍（EMCI）和61个正常队列（NC）。 通过这四个类，我们有六个二进制（一对一）分类任务。 所有图像都存储为体素强度值，形状为110×110×110的三维张量。





### 4. 结果（RESULTS）

​	六个二元分类任务的结果显示在表1中。网络学习从正常队列中准确地分类阿尔茨海默氏病受试者，但是努力将它们与晚期和早期轻度认知障碍的中间类别分开。 两个网络在标准偏差内显示类似的结果。


![image]({{site.baseurl}}/assets/img/dl/7.png)


​	图2显示了培训期间验证数据集的ROC AUC值。 该图表明，在第50个时代之后，网络分类性能不断提高，然后达到稳定水平。


![image]({{site.baseurl}}/assets/img/dl/8.png)
​	图3显示了来自测试子集的正常群组受试者的受阻图像[11]的预测所产生的网络注意力的示例。 我们通过编制预测掩模来制作它，同时用7×7×7盒子遮挡图像部分并测量输出概率的下降。 该热图显示了网络如何了解这些区域的重要性。 这些区域模糊，但最受关注的斑点似乎与受阿尔茨海默病影响最严重的斑点相匹配，主要是海马[12]和脑室[13]。


![image]({{site.baseurl}}/assets/img/dl/9.png)




### 5. 结论（CONCLUSION）

​	我们提出了深度3D卷积神经网络结构，用于脑MRI扫描分类任务。我们基于ADNI数据集证明了残余和普通卷积神经网络的性能，ADNI数据集是阿尔茨海默病和正常对照组织的结构MRI的最大可用数据集。我们展示了将所提出的模型应用于MRI分类问题产生的结果与之前使用的方法相当。我们方法的主要优点是易于使用，不需要手工制作的特征生成。一旦我们能够自动处理用于颅骨剥离和标准化的进入图像，所提出的方法应该证明对任何给定MRI扫描的即时预测是有用的。
​	在我们未来的工作中，我们希望对未经过预处理对齐和头颅剥离的图像获得类似或更好的结果，因为卷积神经网络如果在卷积后具有全局池，则对于图像上的对象的转换是不变的。这意味着可以对复杂的MRI数据进行一步分析，而不是目前主导该领域的多步骤管道。

















